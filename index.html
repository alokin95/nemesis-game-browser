<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Nemesis Game Browser</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background: #121212;
        color: #e0e0e0;
      }
      header {
        background: #1f1f1f;
        padding: 1rem;
        text-align: center;
        font-size: 1.5rem;
        font-weight: bold;
      }
      .tab-container {
        display: flex;
        justify-content: space-around;
        background: #1f1f1f;
        padding: 0.5rem;
        position: sticky;
        top: 0;
        z-index: 10;
      }
      .tab {
        padding: 0.5rem 1rem;
        cursor: pointer;
        border: 1px solid #444;
        border-radius: 4px;
        background: #2a2a2a;
        position: relative;
      }
      .tab.active {
        background: #444;
      }
      .tab.active::after {
        content: "";
        position: absolute;
        bottom: -5px;
        left: 50%;
        transform: translateX(-50%);
        width: 80%;
        height: 4px;
        background: #ff9900;
        border-radius: 2px;
      }
      .content {
        padding: 1rem;
      }
      .game-list,
      .form-container {
        margin-top: 1rem;
      }
      .game-card {
        border: 1px solid #444;
        padding: 1rem;
        margin-bottom: 0.5rem;
        background: #2a2a2a;
        border-radius: 4px;
      }
      .game-card h4 {
        margin: 0 0 0.5rem 0;
      }
      .game-card p {
        margin: 0.2rem 0;
      }
      .button {
        padding: 0.5rem 1rem;
        margin: 0.5rem 0;
        border: none;
        cursor: pointer;
        color: #fff;
        background: #ff9900;
        border-radius: 4px;
        transition: background 0.3s ease;
      }
      .button:hover {
        background: #ffa833;
      }
      .form-container {
        text-align: center;
        max-width: 500px;
        margin: 0 auto;
        background: #1f1f1f;
        padding: 2rem;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      }
      .form-container h3 {
        margin-bottom: 1rem;
      }
      .form-container input,
      .form-container select,
      .form-container textarea {
        width: 100%;
        margin-bottom: 1rem;
        padding: 0.5rem;
        border: 1px solid #444;
        background: #1f1f1f;
        color: #fff;
        border-radius: 4px;
      }
      .form-container label {
        display: block;
        margin-bottom: 0.5rem;
      }
      .modal {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: #1f1f1f;
        padding: 2rem;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        z-index: 1000;
        width: 90%;
        max-width: 400px;
      }
      .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.6);
        z-index: 999;
      }
      .modal.active {
        display: block !important;
      }
      .modal-overlay.active {
        display: block !important;
      }
    </style>
  </head>
  <body>
    <header>Nemesis Game Browser</header>
    <div class="tab-container">
      <div id="host-tab" class="tab active">Host a Game</div>
      <div id="active-tab" class="tab">Active Games</div>
      <div id="joined-tab" class="tab">Joined Games</div>
    </div>
    <div class="content">
      <!-- Host Game Section -->
      <div id="host-section" class="form-container">
        <h3>Host a New Game</h3>
        <input type="text" id="game-name" placeholder="Game Name (optional)" />
        <select id="player-count">
          <option value="">Number of Players (optional)</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
        </select>
        <input
          type="password"
          id="game-password"
          placeholder="Password (optional)"
        />
        <button class="button" id="create-game">Create Game</button>
      </div>
      <!-- Active Games Section -->
      <div id="active-section" class="game-list" style="display: none">
        <h3>Active Games</h3>
        <div id="active-games">
          <div class="game-card">
            <h4>Game Name: Alien Invasion</h4>
            <p><strong>Players Joined:</strong> 3/5</p>
            <p><strong>Password Protected:</strong> Yes</p>
            <p><strong>Started At:</strong> 2025-01-01 14:30</p>
            <button class="button join-game-button">Join</button>
          </div>
        </div>
      </div>
      <!-- Joined Games Section -->
      <div id="joined-section" class="game-list" style="display: none">
        <h3>Joined Games</h3>
        <p>You have not joined any games yet.</p>
      </div>
      <!-- Join Game Modal -->
      <div class="modal-overlay" id="modal-overlay"></div>
      <div class="modal" id="join-modal">
        <h3>Join Game</h3>
        <div class="form-group">
          <label>Character Pick</label>
          <select id="character-pick-modal">
            <option value="">Select Character</option>
            <option value="Engineer">Engineer</option>
            <option value="Scientist">Scientist</option>
          </select>
        </div>
        <div class="form-group">
          <label>Password (if required)</label>
          <input
            type="password"
            id="join-password"
            placeholder="Enter game password"
          />
        </div>
        <button class="button" id="confirm-join">Join Game</button>
        <button class="button" id="cancel-join">Cancel</button>
      </div>
    </div>
    <script src="https://telegram.org/js/telegram-web-app.js?56"></script>
    <script>
      
      const initData = window.Telegram.WebApp.initData;
      const params = new URLSearchParams(initData);
      const user = JSON.parse(params.get('user'));

      const hostTab = document.getElementById("host-tab");
      const activeTab = document.getElementById("active-tab");
      const joinedTab = document.getElementById("joined-tab");

      const hostSection = document.getElementById("host-section");
      const activeSection = document.getElementById("active-section");
      const joinedSection = document.getElementById("joined-section");

      const createGameButton = document.getElementById("create-game");
      const modalOverlay = document.getElementById("modal-overlay");
      const joinModal = document.getElementById("join-modal");
      const confirmJoinButton = document.getElementById("confirm-join");
      const cancelJoinButton = document.getElementById("cancel-join");

      hostTab.addEventListener("click", () => switchTab(hostTab, hostSection));
      activeTab.addEventListener("click", () => {
        switchTab(activeTab, activeSection);
        attachJoinButtonListeners();
      });
      joinedTab.addEventListener("click", () =>
        switchTab(joinedTab, joinedSection),
      );

      createGameButton.addEventListener("click", () => {
        const name = document.getElementById("game-name").value;
        const players = document.getElementById("player-count").value;
        const password = document.getElementById("game-password").value;
        alert("Game created!");
      });

      confirmJoinButton.addEventListener("click", () => {
        const character = document.getElementById("character-pick-modal").value;
        const password = document.getElementById("join-password").value;
        alert("Joined game successfully!");
        closeJoinModal();
      });

      cancelJoinButton.addEventListener("click", closeJoinModal);

      function attachJoinButtonListeners() {
        document.querySelectorAll(".join-game-button").forEach((button) => {
          button.removeEventListener("click", openJoinModal); // Prevent duplicates
          button.addEventListener("click", openJoinModal);
        });
      }

      getAllGames()

      function openJoinModal() {
        joinModal.classList.add("active");
        modalOverlay.classList.add("active");
      }

      function closeJoinModal() {
        joinModal.classList.remove("active");
        modalOverlay.classList.remove("active");
      }

      function switchTab(tab, section) {
        document
          .querySelectorAll(".tab")
          .forEach((t) => t.classList.remove("active"));
        document
          .querySelectorAll(".content > div")
          .forEach((s) => (s.style.display = "none"));
        tab.classList.add("active");
        section.style.display = "block";
      }

      function getAllGames() {
          const apiUrl = "http://localhost:8080/games"

          fetch(apiUrl, {
            method: "GET",
            headers: {
              "Content-Type": "application/json",
            }
          })
          .then((response) => response.json())
          .then((data) => {
              console.log("Server Response:", data);
          })
          .catch((error) => {
              console.error("Error:", error);
          });
      }
    </script>
  </body>
</html>

